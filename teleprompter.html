<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>CinePrompter - Professional Teleprompter</title>
    <link rel="stylesheet" href="teleprompter.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CinePrompter">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Main Teleprompter Canvas -->
    <div id="prompterCanvas" class="prompter-canvas">
        <div class="reading-zone" id="readingZone">
            <div class="prompt-text" id="promptText">
                Tap "Edit Script" below to start using the teleprompter.
            </div>
        </div>
    </div>

    <!-- Reading Zone Guide Lines -->
    <div class="reading-guide">
        <div class="guide-line top"></div>
        <div class="guide-line bottom"></div>
    </div>

    <!-- Top Action Bar -->
    <div class="action-bar" id="actionBar">
        <button class="action-btn" id="editBtn" aria-label="Edit Script">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
        </button>
        <h1 class="app-title">CinePrompter</h1>
        <button class="action-btn" id="settingsBtn" aria-label="Settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="m12 1 2.09 4.26L18 6l-1.09 2.91L15 12l-3.91.91L10 18l-1.91-2.26L6 15l1.09-2.91L9 9l2.09-4.26L12 1z"/>
            </svg>
        </button>
    </div>

    <!-- Floating Control Deck -->
    <div class="control-deck" id="controlDeck">
        <!-- Speed Control -->
        <div class="control-group">
            <label class="control-label">Speed</label>
            <div class="speed-control">
                <button class="speed-btn" id="speedDown" aria-label="Decrease Speed">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5,12 19,6 19,18"/>
                    </svg>
                </button>
                <div class="speed-value" id="speedValue">80px/s</div>
                <button class="speed-btn" id="speedUp" aria-label="Increase Speed">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5,6 19,12 5,18"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Font Size Control -->
        <div class="control-group">
            <label class="control-label">Font Size</label>
            <div class="font-control">
                <button class="font-btn" id="fontDown" aria-label="Decrease Font Size">-</button>
                <div class="font-value" id="fontValue">48pt</div>
                <button class="font-btn" id="fontUp" aria-label="Increase Font Size">+</button>
            </div>
        </div>

        <!-- Mirror Toggle -->
        <div class="control-group">
            <label class="control-label">Mirror</label>
            <div class="mirror-control">
                <label class="switch">
                    <input type="checkbox" id="mirrorToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- Overlay Toggle -->
        <div class="control-group">
            <label class="control-label">Overlay</label>
            <div class="mirror-control">
                <label class="switch">
                    <input type="checkbox" id="overlayToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- Playback Control -->
        <div class="control-group">
            <button class="play-btn" id="playBtn" aria-label="Play/Pause">
                <svg class="play-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <polygon points="8,5 19,12 8,19"/>
                </svg>
                <svg class="pause-icon hidden" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <rect x="6" y="4" width="4" height="16"/>
                    <rect x="14" y="4" width="4" height="16"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Script Editor Modal -->
    <div class="modal-overlay" id="editorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Script</h2>
                <button class="close-btn" id="closeEditor" aria-label="Close">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <textarea 
                    id="scriptInput" 
                    placeholder="Paste or type your script here..."
                    maxlength="10000"
                ></textarea>
                <div class="char-count" id="charCount">0 / 10000</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="clearScript">Clear</button>
                <button class="btn btn-primary" id="loadScript">Load Script</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="close-btn" id="closeSettings" aria-label="Close">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label>Default Speed (pixels/second)</label>
                    <input type="range" id="defaultSpeed" min="10" max="300" step="5" value="80">
                    <span class="setting-value" id="defaultSpeedValue">80px/s</span>
                </div>
                <div class="setting-group">
                    <label>Default Font Size</label>
                    <input type="range" id="defaultFontSize" min="24" max="96" step="2" value="48">
                    <span class="setting-value" id="defaultFontValue">48pt</span>
                </div>
                <div class="setting-group">
                    <label>Reading Zone Position</label>
                    <input type="range" id="readingZonePos" min="10" max="50" value="30">
                    <span class="setting-value" id="readingZoneValue">30%</span>
                </div>
                <div class="setting-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="showGuides" checked>
                        <span>Show Reading Guides</span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveSettings">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading script...</div>
    </div>

    <!-- Overlay Instructions -->
    <div class="overlay-instructions hidden" id="overlayInstructions">
        <div class="instructions-content">
            <h3>üì± Teleprompter Overlay Mode</h3>
            <p><strong>How to use with camera recording:</strong></p>
            <ol>
                <li><strong>Setup:</strong> Make sure CinePrompter is installed as a PWA (Add to Home Screen)</li>
                <li><strong>Recording App:</strong> Open your video recording app</li>
                <li><strong>Split Screen:</strong> Use iOS split screen or Picture-in-Picture mode</li>
                <li><strong>Start Recording:</strong> Begin recording in your video app</li>
                <li><strong>Switch Apps:</strong> Quickly switch to CinePrompter during recording</li>
                <li><strong>Overlay Text:</strong> Use teleprompter while recording continues</li>
            </ol>
            <p><strong>üí° Pro Tip:</strong> Practice the app switching beforehand for smooth recording!</p>
            <p><strong>‚ö†Ô∏è Note:</strong> iOS doesn't allow web apps to overlay system camera apps directly. This is the best workaround.</p>
            <button class="btn btn-primary" onclick="this.parentElement.parentElement.classList.add('hidden')">Got it!</button>
        </div>
    </div>

    <script src="teleprompter.js"></script>
    
    <!-- Service Worker Registration for PWA -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('CinePrompter: Service Worker registered successfully');
                    })
                    .catch((error) => {
                        console.log('CinePrompter: Service Worker registration failed');
                    });
            });
        }
    </script>
</body>
</html>